% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_Single_PIPET.R
\name{PIPET_SingleAnalysis}
\alias{PIPET_SingleAnalysis}
\title{Single-Cell Subpopulation Prediction}
\usage{
PIPET_SingleAnalysis(
  sc_data,
  markers,
  rm_NA = TRUE,
  freq_counts = NULL,
  normalize = TRUE,
  scale = TRUE,
  nPerm = 1000L,
  distance = c("cosine", "pearson", "spearman", "kendall", "euclidean", "maximum"),
  ...
)
}
\arguments{
\item{sc_data}{A Seurat object containing single-cell RNA-seq data}

\item{markers}{A data frame containing marker gene information with columns:
\itemize{
\item genes: Gene identifiers matching rownames of sc_data
\item class: Class labels for each gene
}}

\item{rm_NA}{Logical indicating whether to remove NA values (default: TRUE)}

\item{freq_counts}{Integer threshold for minimum number of cells expressing a gene.
Genes expressed in fewer cells will be removed (default: NULL, no filtering)}

\item{normalize}{Logical indicating whether to normalize count data using CPM
and log1p transformation (default: TRUE)}

\item{scale}{Logical indicating whether to z-score normalize features (default: TRUE)}

\item{nPerm}{Number of permutations for null distribution estimation (default: 1000)}

\item{distance}{Distance/similarity metric to use. Options include:
\itemize{
\item "cosine": Cosine similarity
\item "pearson": Pearson correlation
\item "spearman": Spearman correlation
\item "kendall": Kendall correlation
\item "euclidean": Euclidean distance
\item "maximum": Maximum distance
}}

\item{...}{Additional parameters including:
\itemize{
\item seed: Random seed for reproducibility
\item verbose: Whether to show progress messages
\item parallel: Whether to use parallel processing
}}
}
\value{
A data.frame with rows representing cells and columns containing:
\item{prediction}{Predicted subpopulation labels based on template matching}
\item{dist_*}{Distance/similarity scores for each class template}
\item{Pvalue}{Nominal p-value estimated from permutation testing}
\item{FDR}{False discovery rate adjusted p-values}
}
\description{
Predicts cell subpopulations in single-cell data by matching expression profiles
to predefined marker gene templates using various distance/similarity metrics.
This function implements a template-based classification approach with permutation
testing for significance assessment.
}
\examples{
\dontrun{
# Run template matching
results <- PIPET_SingleAnalysis(
sc_data = seurat_obj,
markers = markers,
distance = "cosine",
nPerm = 1000
)

# View results
head(results)
table(results$prediction)
}

}
\references{
Hoshida, Y. (2010). Nearest Template Prediction: A Single-Sample-Based Flexible
Class Prediction with Confidence Assessment. PLoS ONE 5, e15543.
}
\seealso{
\code{\link[=PIPET_GroupAnalysis]{PIPET_GroupAnalysis()}} for group-wise analysis,
\code{\link[=corCosine]{corCosine()}} for cosine similarity calculation,
\code{\link[=disFun]{disFun()}} for distance calculations
}
