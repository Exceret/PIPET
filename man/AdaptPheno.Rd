% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/15_AdaptPheno.R
\name{AdaptPheno}
\alias{AdaptPheno}
\title{Adapt Phenotype Vector for Downstream Analysis}
\usage{
AdaptPheno(
  phenotype,
  discretize_method = c("kmeans", "median", "custom"),
  cutoff = NULL,
  phenotype_type = c("binary", "continuous"),
  ...
)
}
\arguments{
\item{phenotype}{A named numeric vector. Names must correspond to sample IDs.
For \code{"binary"} phenotype_type, values are expected to be 0/1 (or equivalent).}

\item{discretize_method}{\code{c("median", "kmeans", "custom")}. Discretization
strategy for continuous phenotypes. Note: \code{"median"} is mapped internally to
\code{"quantile"} (2-group quantile split). Default: \code{"median"}.}

\item{cutoff}{Numeric vector of length \code{n_group - 1}. Required only when
\code{discretize_method = "custom"}. Defines interior breakpoints on the
\emph{normalized, log2-transformed scale} (i.e., after \code{scale(log2(x + 1))}).
Must be sorted in ascending order.}

\item{phenotype_type}{\code{c("binary", "continuous")}. If missing or
length > 1 and \code{phenotype} is named numeric, auto-detection is attempted:
inferred as \code{"binary"} if exactly two unique values exist, otherwise \code{"continuous"}.
If auto-detection fails or input is non-numeric/unamed, an error is thrown.}

\item{...}{Additional arguments (currently unused, reserved for future extension).}
}
\value{
A two-column \code{data.frame}:
\describe{
\item{sample}{Sample IDs (from \code{names(phenotype)})}
\item{class}{Discrete class labels as a factor. For binary phenotypes:
\code{"group_1"} (value == 1) and \code{"group_0"} (value != 1). For continuous:
\code{"group_1"}, \code{"group_2"}, ..., ordered by increasing mean of normalized
phenotype within group (for \code{"kmeans"}), or by quantile/custom interval.}
}
}
\description{
Converts a named numeric phenotype vector into a standardized data frame with
discrete class labels, suitable for survival analysis, differential expression,
or machine learning workflows. Supports both binary and continuous phenotypes.
For continuous phenotypes, performs automatic discretization based on the
specified method (e.g., quantile-based, k-means clustering, or custom cutoffs).
Internally applies log2(x+1) transformation and z-scoring before discretization
to stabilize variance and improve cluster separation.
}
\section{Notes}{

\itemize{
\item Binary phenotype validation: exactly two unique values required; if more,
use \code{phenotype_type = "continuous"}.
\item Continuous phenotype with only two unique values will error â€” explicitly
declare as binary in such edge cases (e.g., dichotomized lab values).
\item Discretization is performed on \code{scale(log2(phenotype + 1))} to
ensure robustness for skewed genomic/clinical data (e.g., gene expression,
biomarker levels). Cutoffs must be specified on this transformed scale.
}
}

\examples{
\dontrun{
# Binary phenotype (auto-detected)
pheno_bin <- c(A = 1, B = 0, C = 1, D = 0)
AdaptPheno(pheno_bin)

# Continuous phenotype: 3-group quantile split
set.seed(123)
pheno_cont <- rlnorm(20, meanlog = 5, sdlog = 1)
names(pheno_cont) <- paste0("S", 1:20)
AdaptPheno(pheno_cont, phenotype_type = "continuous", n_group = 3)

# Custom cutoffs (e.g., normalized expression > 1.5 = high)
# Suppose we want 2 groups with cutoff at z = 0.5 on normalized scale
AdaptPheno(pheno_cont,
           phenotype_type = "continuous",
           discretize_method = "custom",
           cutoff = 0.5,
           n_group = 2)
}
}
